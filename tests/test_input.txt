{##### common.yml #####}
{%- block common_yaml -%}
[{{ config_location }}]
[config.yml]
version: 2

models:
  - materialization: view

{% endblock -%}

{##### end of common-yml #####}
{##### single_model.yml #####}
{%- block single_yaml -%}
{%- for model in models %}
#### split ####
[{{ model.test_path}}]
[{{ model.test_name }}]
version: 2

models:
  - name: {{ model.model_name }} 
    columns:
    {%- for column in model.select_expr.values() %}
    - name: {{ column['name'] }}
      {%- if model.primary_keys is not none and column['name'] in model.primary_keys %}
      tests:
        - unique
        - not null
      {% endif -%}
    {%- endfor %}   
{% endfor -%}
{% endblock %}
